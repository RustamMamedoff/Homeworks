{"version":3,"file":"Select.js","sources":["../src/Select.tsx"],"sourcesContent":["import FormControl, { FormControlProps } from '@mui/material/FormControl';\nimport FormHelperText, {\n  FormHelperTextProps,\n} from '@mui/material/FormHelperText';\nimport InputLabel, { InputLabelProps } from '@mui/material/InputLabel';\nimport MuiSelect, { SelectProps as MuiSelectProps } from '@mui/material/Select';\nimport { FieldProps, getIn } from 'formik';\nimport * as React from 'react';\n\nexport interface SelectProps\n  extends FieldProps,\n    Omit<MuiSelectProps, 'name' | 'value'> {\n  formControl?: FormControlProps;\n  formHelperText?: FormHelperTextProps;\n  inputLabel?: InputLabelProps;\n}\n\nexport function fieldToSelect({\n  disabled,\n  field: { onBlur: _onBlur, onChange: fieldOnChange, ...field },\n  form: { isSubmitting, touched, errors, setFieldTouched, setFieldValue },\n  onClose,\n  ...props\n}: Omit<\n  SelectProps,\n  'formControl' | 'formHelperText' | 'inputLabel'\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n>): MuiSelectProps & { formError: any } {\n  const fieldError = getIn(errors, field.name);\n  const showError = getIn(touched, field.name) && !!fieldError;\n\n  return {\n    disabled: disabled ?? isSubmitting,\n    error: showError,\n    formError: showError ? fieldError : undefined,\n    onBlur: () => {\n      // no-op\n    },\n    onChange:\n      fieldOnChange ??\n      (() => {\n        // no-op\n      }),\n    // we must use `onClose` instead of `onChange` to be able to trigger validation when users click outside of the select list.\n    onClose:\n      onClose ??\n      (async (e: React.SyntheticEvent) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const dataset = (e.target as any).dataset as DOMStringMap;\n        if (dataset && dataset.value) {\n          // out-of-sync issue since November 2019: https://github.com/formium/formik/issues/2059#issuecomment-890613538\n          // without the await, formik validates with the former value\n          await setFieldValue(field.name, dataset.value, false);\n        }\n        setFieldTouched(field.name, true, true);\n      }),\n    ...field,\n    ...props,\n  };\n}\n\nexport function Select({\n  formControl,\n  inputLabel,\n  formHelperText,\n  ...selectProps\n}: SelectProps) {\n  const { error, formError, disabled, ...selectFieldProps } =\n    fieldToSelect(selectProps);\n  const { children: formHelperTextChildren, ...formHelperTextProps } =\n    formHelperText || {};\n  const shouldDisplayFormHelperText = error || formHelperTextChildren;\n\n  return (\n    <FormControl disabled={disabled} error={error} {...formControl}>\n      <InputLabel id={selectFieldProps.labelId} {...inputLabel}>\n        {selectFieldProps.label}\n      </InputLabel>\n      <MuiSelect {...selectFieldProps} />\n      {shouldDisplayFormHelperText && (\n        <FormHelperText {...formHelperTextProps}>\n          {error ? formError : formHelperTextChildren}\n        </FormHelperText>\n      )}\n    </FormControl>\n  );\n}\n\nSelect.displayName = 'FormikMaterialUISelect';\n"],"names":[],"mappings":";;;;;;AAiBO,SAAS,cAAc;AAAA,EAC5B;AAAA,EACA,OAAO,EAAE,QAAQ,SAAS,UAAU,eAAe,GAAG,MAAM;AAAA,EAC5D,MAAM,EAAE,cAAc,SAAS,QAAQ,iBAAiB,cAAc;AAAA,EACtE;AAAA,EACA,GAAG;AACL,GAIwC;AACtC,QAAM,aAAa,MAAM,QAAQ,MAAM,IAAI;AAC3C,QAAM,YAAY,MAAM,SAAS,MAAM,IAAI,KAAK,CAAC,CAAC;AAE3C,SAAA;AAAA,IACL,UAAU,YAAY;AAAA,IACtB,OAAO;AAAA,IACP,WAAW,YAAY,aAAa;AAAA,IACpC,QAAQ,MAAM;AAAA,IAEd;AAAA,IACA,UACE,kBACC,MAAM;AAAA,IAAA;AAAA;AAAA,IAIT,SACE,YACC,OAAO,MAA4B;AAE5B,YAAA,UAAW,EAAE,OAAe;AAC9B,UAAA,WAAW,QAAQ,OAAO;AAG5B,cAAM,cAAc,MAAM,MAAM,QAAQ,OAAO,KAAK;AAAA,MACtD;AACgB,sBAAA,MAAM,MAAM,MAAM,IAAI;AAAA,IAAA;AAAA,IAE1C,GAAG;AAAA,IACH,GAAG;AAAA,EAAA;AAEP;AAEO,SAAS,OAAO;AAAA,EACrB;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACL,GAAgB;AACR,QAAA,EAAE,OAAO,WAAW,UAAU,GAAG,qBACrC,cAAc,WAAW;AAC3B,QAAM,EAAE,UAAU,wBAAwB,GAAG,oBAAoB,IAC/D,kBAAkB;AACpB,QAAM,8BAA8B,SAAS;AAE7C,SACG,qBAAA,aAAA,EAAY,UAAoB,OAAe,GAAG,aACjD,UAAA;AAAA,IAAA,oBAAC,cAAW,IAAI,iBAAiB,SAAU,GAAG,YAC3C,2BAAiB,OACpB;AAAA,IACA,oBAAC,WAAW,EAAA,GAAG,kBAAkB;AAAA,IAChC,+BACE,oBAAA,gBAAA,EAAgB,GAAG,qBACjB,UAAA,QAAQ,YAAY,wBACvB;AAAA,EAEJ,EAAA,CAAA;AAEJ;AAEA,OAAO,cAAc;"}